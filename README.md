# 交互式人体疾病数据可视化应用 (PDC风格)

这是一个基于R Shiny的交互式人体疾病数据可视化应用，参考了PDC (Proteomic Data Commons) 网站的设计风格。应用采用左侧人体图 + 右侧柱状图的布局，允许用户通过直观的方式探索不同器官的疾病数据。

## 功能特点

- **PDC风格界面**: 参考专业医学数据库的设计，采用蓝色渐变背景和现代化UI
- **双面板布局**: 左侧交互式人体图，右侧实时柱状图数据可视化
- **器官高亮**: 鼠标悬停和点击时的视觉反馈效果
- **实时数据同步**: 人体图和柱状图之间的双向交互
- **用户认证**: 集成了用户登录系统（用户名/密码：user01/password01 或 user02/password02）
- **专业数据展示**: 使用DataTables展示蛋白质修饰相关数据
- **响应式设计**: 支持不同屏幕尺寸的设备，移动端自动调整为垂直布局

## 文件结构

```
├── app.R                    # 主应用文件
├── background.png           # 人体轮廓背景图
├── www/
│   ├── background.png       # 网页可访问的背景图
│   └── image.jpg           # 原有的占位图片
├── all_data_kidney_disease_opensearch/
│   ├── Nephropathy_MOD_Count_part.csv    # MOD计数数据
│   ├── Nephropathy_Scale_MOD_part.csv    # 规模MOD数据
│   └── Nephropathy_Site_Count_part.csv   # 位点计数数据
├── test_app.R              # 应用测试脚本
├── run_app.R               # 简化的启动脚本
└── README.md               # 说明文档
```

## 安装要求

### R包依赖
```r
install.packages(c(
  "shiny",
  "DT", 
  "shinymanager",
  "data.table"
))
```

### 系统要求
- R (版本 >= 4.0.0)
- 现代网页浏览器（Chrome、Firefox、Safari、Edge）

## 运行应用

### 方法1: 直接运行
```r
# 在R控制台中
shiny::runApp("app.R")
```

### 方法2: 使用启动脚本
```r
# 运行启动脚本
source("run_app.R")
```

### 方法3: 命令行运行
```bash
# 在命令行中
Rscript -e "shiny::runApp('app.R', port = 3838, host = '0.0.0.0')"
```

## 使用说明

1. **启动应用**: 运行应用后，在浏览器中访问 `http://localhost:3838`

2. **用户登录**:
   - 用户名: `user01` 密码: `password01`
   - 用户名: `user02` 密码: `password02`

3. **主界面交互**:
   - **左侧人体图**: 显示人体轮廓，包含12个可交互的器官区域
   - **右侧柱状图**: 实时显示各器官的病例数量统计
   - **器官选择**: 单击器官区域或柱状图项目进行选择（高亮显示）
   - **详细查看**: 双击选中的器官进入详细数据页面

4. **数据页面功能**:
   - 查看三种类型的蛋白质修饰数据：Modification Counts、Scale Modifications、Site Counts
   - 使用交互式表格进行数据搜索、排序和筛选
   - 点击"返回概览"按钮回到主界面

5. **视觉反馈**:
   - 器官悬停时显示蓝色高亮效果
   - 选中器官显示黄色高亮
   - 柱状图和人体图同步高亮显示

## 器官映射和数据分布

当前应用支持以下器官的数据查看，右侧柱状图显示各器官的病例数量：

| 器官名称 | 英文名称 | 病例数 | 数据表 | 柱状图宽度 |
|---------|---------|-------|--------|-----------|
| **肺部** | Lung | 620 | Table 1 | 100% |
| **大脑** | Brain | 580 | Table 2 | 95% |
| **骨髓和血液** | Bone Marrow and Blood | 520 | Table 1 | 85% |
| **胰腺** | Pancreas | 490 | Table 1 | 80% |
| **乳腺** | Breast | 460 | Table 2 | 75% |
| **卵巢** | Ovary | 430 | Table 3 | 70% |
| **结直肠** | Colorectal | 370 | Table 2 | 60% |
| **头颈部** | Head and Neck | 340 | Table 2 | 55% |
| **肾脏** | Kidney | 310 | Table 1 | 50% |
| **肝脏** | Liver | 280 | Table 3 | 45% |
| **子宫** | Uterus | 250 | Table 3 | 40% |
| **胃** | Stomach | 150 | Table 3 | 25% |

*注：病例数为示例数据，实际数据来源于肾病相关的蛋白质修饰数据集*

## 数据说明

应用使用三个主要的数据文件：

1. **Nephropathy_MOD_Count_part.csv**: 包含修饰计数数据
2. **Nephropathy_Scale_MOD_part.csv**: 包含规模修饰数据  
3. **Nephropathy_Site_Count_part.csv**: 包含位点计数数据

每个文件都是原始数据的前1000行，用于演示和性能优化。

## 测试

运行测试脚本来验证应用配置：

```r
source("test_app.R")
```

测试脚本会检查：
- 必要的R包是否已安装
- 数据文件是否存在
- 静态文件是否正确放置
- 数据是否能正常加载

## 技术特点

- **响应式设计**: 支持移动设备和桌面设备
- **现代UI**: 使用Bootstrap样式和自定义CSS
- **交互反馈**: 点击效果、悬停提示、加载动画
- **数据安全**: 用户认证保护数据访问
- **性能优化**: 使用数据子集提高加载速度

## 故障排除

### 常见问题

1. **应用无法启动**
   - 检查R包是否正确安装
   - 确认数据文件路径正确
   - 运行测试脚本诊断问题

2. **背景图不显示**
   - 确认 `www/background.png` 文件存在
   - 检查文件权限

3. **数据表格为空**
   - 检查CSV文件是否存在且格式正确
   - 确认文件编码为UTF-8

4. **登录失败**
   - 使用正确的用户名密码组合
   - 检查shinymanager包是否正确安装

## 自定义和扩展

### 添加新器官
1. 在CSS中定义新的器官位置类
2. 在HTML中添加新的器官区域div
3. 在服务器逻辑中添加对应的点击处理

### 修改数据映射
在 `observeEvent(input$organ_clicked, {...})` 中修改器官到数据表的映射关系。

### 更换背景图
替换 `www/background.png` 文件，并根据需要调整器官位置的CSS坐标。

## 许可证

本项目仅用于学术和研究目的。

## 联系信息

如有问题或建议，请联系开发团队。
